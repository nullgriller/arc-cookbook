<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Details</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <h1 id="recipeTitle">Loading...</h1>
</header>

<section class="recipe-detail-card" id="recipeDetail"></section>

<footer>
    <a href="index.html" class="back-button">‚Üê Back to all recipes</a>
</footer>

<script>
const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRTkcgTI-Sr63QI8AruuEhhki1PMzF5pFV2eRw-h6PgydS6499aiTZ7iGcqaW3sppjpTZfEGCoPNN6-/pub?output=csv";

const params = new URLSearchParams(window.location.search);
const recipeId = params.get("id");

async function loadRecipe() {
    const res = await fetch(sheetUrl);
    const csvText = await res.text();
    const rows = csvText.split("\n").map(r => r.split(","));

    const dataRows = rows.slice(1);

    const row = dataRows[recipeId];
    if (!row) {
        document.getElementById("recipeDetail").innerHTML = "<p>Recipe not found.</p>";
        return;
    }

    const [
        nameOfPerson,
        nameOfRecipe,
        ingredients,
        instructions,
        allergens,
        story
    ] = row.map(cell => cell.replace(/"/g, ""));

    document.getElementById("recipeTitle").innerText = nameOfRecipe;

    document.getElementById("recipeDetail").innerHTML = `
        <div class="recipe-section-title">Submitted by</div>
        <p>${nameOfPerson}</p>

        <div class="recipe-section-title">Ingredients</div>
        <p>${ingredients.replace(/;/g, "<br>")}</p>

        <div class="recipe-section-title">Instructions</div>
        <p>${instructions.replace(/;/g, "<br>")}</p>

        <div class="recipe-section-title">Allergens</div>
        <p>${allergens}</p>

        <div class="recipe-section-title">Story Behind the Recipe</div>
        <p>${story}</p>
    `;
}

loadRecipe();
</script>

</body>
</html>
